<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego del Amor - Para KIM</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .game-container {
            max-width: 800px;
            margin: 100px auto 50px;
            padding: 20px;
            text-align: center;
        }
        
        .game-title {
            font-family: 'Dancing Script', cursive;
            font-size: 3.5rem;
            margin-bottom: 30px;
            color: var(--dark-color);
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .game-stats {
            display: flex;
            justify-content: space-around;
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            display: block;
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent-color);
            font-family: 'Dancing Script', cursive;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--dark-color);
            opacity: 0.8;
        }
        
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
            min-height: 450px;
        }
        
        .memory-card {
            aspect-ratio: 1;
            background: var(--gradient);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.6s ease;
            position: relative;
            user-select: none;
            perspective: 1000px;
        }
        
        .memory-card.flipped {
            transform: rotateY(180deg);
        }
        
        .memory-card.matched {
            transform: rotateY(180deg);
            cursor: default;
        }
        
        .memory-card .front,
        .memory-card .back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            top: 0;
            left: 0;
        }
        
        .memory-card .front {
            background: var(--light-color);
            transform: rotateY(180deg);
            color: var(--accent-color);
        }
        
        .memory-card .back {
            background: var(--gradient);
            color: white;
            transform: rotateY(0deg);
        }
        
        .memory-card.matched .front {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: rotateY(180deg) scale(1); }
            50% { transform: rotateY(180deg) scale(1.05); }
        }
        
        .game-controls {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .game-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 30px;
            background: var(--gradient);
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .game-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 107, 139, 0.4);
        }
        
        .game-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
        }
        
        .back-button a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            background: var(--gradient);
            color: white;
            text-decoration: none;
            border-radius: 30px;
            transition: var(--transition);
        }
        
        .back-button a:hover {
            transform: translateX(-5px);
        }
        
        .victory-message {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }
        
        .victory-message.show {
            opacity: 1;
            pointer-events: all;
        }
        
        .victory-content {
            background: white;
            padding: 50px;
            border-radius: 30px;
            text-align: center;
            transform: scale(0.8);
            transition: transform 0.5s;
            max-width: 90%;
            width: 500px;
        }
        
        .victory-message.show .victory-content {
            transform: scale(1);
        }
        
        .victory-content h2 {
            font-family: 'Dancing Script', cursive;
            font-size: 3rem;
            color: var(--accent-color);
            margin-bottom: 20px;
        }
        
        .score-message {
            font-size: 1.2rem;
            margin: 10px 0;
            padding: 10px;
            border-radius: 10px;
            background: var(--light-color);
        }
        
        .game-difficulty {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .difficulty-btn {
            padding: 8px 20px;
            border: 2px solid var(--secondary-color);
            background: transparent;
            color: var(--dark-color);
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .difficulty-btn.active {
            background: var(--gradient);
            color: white;
            border-color: transparent;
        }
        
        @media (max-width: 768px) {
            .memory-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 10px;
                min-height: 400px;
            }
            
            .game-title {
                font-size: 2.5rem;
            }
            
            .game-stats {
                flex-direction: row;
                gap: 15px;
                padding: 15px;
            }
            
            .memory-card {
                font-size: 2rem;
            }
            
            .victory-content {
                padding: 30px;
                width: 90%;
            }
            
            .victory-content h2 {
                font-size: 2.2rem;
            }
        }
        
        @media (max-width: 480px) {
            .memory-grid {
                grid-template-columns: repeat(3, 1fr);
                min-height: 350px;
            }
            
            .game-stats {
                flex-direction: column;
                gap: 10px;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="background-animation"></div>
    <div id="particles-js"></div>
    
    <div class="back-button">
        <a href="index.html">
            <i class="fas fa-arrow-left"></i> Volver al inicio
        </a>
    </div>
    
    <div class="game-container">
        <h1 class="game-title">Juego de la Memoria del Amor</h1>
        
        <div class="game-difficulty">
            <button class="difficulty-btn active" data-difficulty="easy">F√°cil (4x4)</button>
            <button class="difficulty-btn" data-difficulty="medium">Medio (4x5)</button>
            <button class="difficulty-btn" data-difficulty="hard">Dif√≠cil (5x6)</button>
        </div>
        
        <div class="game-stats">
            <div class="stat">
                <span class="stat-value" id="moves">0</span>
                <span class="stat-label">Movimientos</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="timer">00:00</span>
                <span class="stat-label">Tiempo</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="pairs">0/8</span>
                <span class="stat-label">Parejas</span>
            </div>
        </div>
        
        <div class="memory-grid" id="memory-grid">
            <!-- Las cartas se generar√°n con JavaScript -->
        </div>
        
        <div class="game-controls">
            <button class="game-btn" id="start-game">
                <i class="fas fa-play"></i> Comenzar Juego
            </button>
            <button class="game-btn" id="reset-game">
                <i class="fas fa-redo"></i> Reiniciar
            </button>
            <button class="game-btn" id="hint-btn">
                <i class="fas fa-lightbulb"></i> Pista
            </button>
        </div>
    </div>
    
    <div class="victory-message" id="victory-message">
        <div class="victory-content">
            <h2>¬°Felicidades mi amor! üéâ</h2>
            <p>Has encontrado todas las parejas de nuestro amor</p>
            <div id="final-stats"></div>
            <button class="game-btn" id="play-again">
                <i class="fas fa-heart"></i> Jugar Otra Vez
            </button>
        </div>
    </div>
    
    <script>
        // Emojis de amor para el juego
        const cardSets = {
            easy: [
                '‚ù§Ô∏è', 'üíï', 'üíò', 'üíù', 'üíñ', 'üíó', 'üíì', 'üíû'
            ],
            medium: [
                '‚ù§Ô∏è', 'üíï', 'üíò', 'üíù', 'üíñ', 'üíó', 'üíì', 'üíû',
                'üòç', 'ü•∞', 'üòò', 'üíã', 'üë©‚Äç‚ù§Ô∏è‚Äçüë®', 'üíë', 'üíè', 'üíí',
                'üéÅ', 'üíç', 'üíå', 'üíê'
            ],
            hard: [
                '‚ù§Ô∏è', 'üíï', 'üíò', 'üíù', 'üíñ', 'üíó', 'üíì', 'üíû',
                'üòç', 'ü•∞', 'üòò', 'üíã', 'üë©‚Äç‚ù§Ô∏è‚Äçüë®', 'üíë', 'üíè', 'üíí',
                'üéÅ', 'üíç', 'üíå', 'üíê', 'üåπ', '‚≠ê', '‚ú®', 'üé∂',
                'üí´', 'üåô', '‚òÄÔ∏è', 'üåà', 'ü¶ã', 'üê¨'
            ]
        };
        
        // Configuraci√≥n de dificultad
        const difficultyConfig = {
            easy: { gridSize: 4, pairs: 8 },
            medium: { gridSize: 5, pairs: 10 },
            hard: { gridSize: 6, pairs: 15 }
        };
        
        let gameState = {
            moves: 0,
            pairsFound: 0,
            totalPairs: 8,
            timer: 0,
            timerInterval: null,
            flippedCards: [],
            canFlip: true,
            gameStarted: false,
            difficulty: 'easy',
            cards: [],
            gridSize: 4,
            hintUsed: 0
        };
        
        const elements = {
            memoryGrid: document.getElementById('memory-grid'),
            moves: document.getElementById('moves'),
            timer: document.getElementById('timer'),
            pairs: document.getElementById('pairs'),
            startBtn: document.getElementById('start-game'),
            resetBtn: document.getElementById('reset-game'),
            hintBtn: document.getElementById('hint-btn'),
            victoryMessage: document.getElementById('victory-message'),
            finalStats: document.getElementById('final-stats'),
            playAgainBtn: document.getElementById('play-again'),
            difficultyBtns: document.querySelectorAll('.difficulty-btn')
        };
        
        function initGame() {
            setupEventListeners();
            setupDifficultyButtons();
            createCards();
            updateStats();
            updateGridLayout();
        }
        
        function setupDifficultyButtons() {
            elements.difficultyBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    if (gameState.gameStarted) return;
                    
                    elements.difficultyBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    gameState.difficulty = btn.dataset.difficulty;
                    const config = difficultyConfig[gameState.difficulty];
                    gameState.totalPairs = config.pairs;
                    gameState.gridSize = config.gridSize;
                    
                    resetGame();
                });
            });
        }
        
        function createCards() {
            elements.memoryGrid.innerHTML = '';
            
            // Seleccionar cartas seg√∫n la dificultad
            const cardSet = cardSets[gameState.difficulty];
            const cardsNeeded = gameState.totalPairs * 2;
            
            // Seleccionar cartas aleatorias del set
            const selectedCards = [...cardSet]
                .sort(() => Math.random() - 0.5)
                .slice(0, gameState.totalPairs);
            
            // Duplicar y mezclar
            let gameCards = [...selectedCards, ...selectedCards]
                .sort(() => Math.random() - 0.5)
                .slice(0, cardsNeeded);
            
            gameState.cards = gameCards;
            
            // Crear la cuadr√≠cula seg√∫n el tama√±o
            const totalCards = gameCards.length;
            const gridTemplate = `repeat(${gameState.gridSize}, 1fr)`;
            elements.memoryGrid.style.gridTemplateColumns = gridTemplate;
            
            gameCards.forEach((emoji, index) => {
                const card = document.createElement('div');
                card.className = 'memory-card';
                card.dataset.index = index;
                card.dataset.emoji = emoji;
                
                card.innerHTML = `
                    <div class="front">${emoji}</div>
                    <div class="back">‚ù§Ô∏è</div>
                `;
                
                card.addEventListener('click', () => handleCardClick(card));
                elements.memoryGrid.appendChild(card);
            });
        }
        
        function setupEventListeners() {
            elements.startBtn.addEventListener('click', startGame);
            elements.resetBtn.addEventListener('click', resetGame);
            elements.hintBtn.addEventListener('click', giveHint);
            elements.playAgainBtn.addEventListener('click', resetGame);
        }
        
        function startGame() {
            if (gameState.gameStarted) return;
            
            gameState.gameStarted = true;
            gameState.timerInterval = setInterval(() => {
                gameState.timer++;
                updateTimer();
            }, 1000);
            
            elements.startBtn.disabled = true;
            elements.hintBtn.disabled = false;
            
            // Mostrar todas las cartas brevemente al inicio
            showAllCardsTemporarily();
        }
        
        function showAllCardsTemporarily() {
            const allCards = document.querySelectorAll('.memory-card');
            allCards.forEach(card => {
                card.classList.add('flipped');
            });
            
            setTimeout(() => {
                allCards.forEach(card => {
                    if (!card.classList.contains('matched')) {
                        card.classList.remove('flipped');
                    }
                });
            }, 1500); // Mostrar por 1.5 segundos
        }
        
        function handleCardClick(card) {
            if (!gameState.gameStarted || !gameState.canFlip || 
                gameState.flippedCards.length >= 2 || 
                card.classList.contains('flipped') ||
                card.classList.contains('matched')) {
                return;
            }
            
            flipCard(card);
            gameState.flippedCards.push(card);
            
            if (gameState.flippedCards.length === 2) {
                gameState.moves++;
                updateStats();
                checkForMatch();
            }
        }
        
        function flipCard(card) {
            card.classList.add('flipped');
            playFlipSound();
        }
        
        function checkForMatch() {
            gameState.canFlip = false;
            
            const [card1, card2] = gameState.flippedCards;
            const isMatch = card1.dataset.emoji === card2.dataset.emoji;
            
            setTimeout(() => {
                if (isMatch) {
                    // Marcarlas como emparejadas
                    card1.classList.add('matched');
                    card2.classList.add('matched');
                    gameState.pairsFound++;
                    
                    // Efecto especial
                    playMatchSound();
                    createHeartsEffect(card1);
                    
                    if (gameState.pairsFound === gameState.totalPairs) {
                        setTimeout(endGame, 500);
                    }
                } else {
                    // Voltearlas de nuevo
                    card1.classList.remove('flipped');
                    card2.classList.remove('flipped');
                }
                
                // Limpiar y permitir nuevos movimientos
                gameState.flippedCards = [];
                gameState.canFlip = true;
            }, 800); // Tiempo suficiente para ver las cartas
        }
        
        function giveHint() {
            if (!gameState.gameStarted || gameState.hintUsed >= 3) return;
            
            // Encontrar cartas no emparejadas
            const unflippedCards = Array.from(document.querySelectorAll('.memory-card:not(.flipped):not(.matched)'));
            
            if (unflippedCards.length >= 2) {
                // Elegir una carta al azar
                const randomCard = unflippedCards[Math.floor(Math.random() * unflippedCards.length)];
                
                // Encontrar su pareja
                const emoji = randomCard.dataset.emoji;
                const matchingCard = unflippedCards.find(card => 
                    card !== randomCard && 
                    card.dataset.emoji === emoji && 
                    !card.classList.contains('flipped') && 
                    !card.classList.contains('matched')
                );
                
                if (matchingCard) {
                    // Mostrar ambas cartas brevemente
                    randomCard.classList.add('flipped');
                    matchingCard.classList.add('flipped');
                    
                    setTimeout(() => {
                        if (!randomCard.classList.contains('matched')) {
                            randomCard.classList.remove('flipped');
                        }
                        if (!matchingCard.classList.contains('matched')) {
                            matchingCard.classList.remove('flipped');
                        }
                    }, 1500);
                    
                    gameState.hintUsed++;
                    elements.hintBtn.innerHTML = `<i class="fas fa-lightbulb"></i> Pista (${3 - gameState.hintUsed})`;
                    
                    if (gameState.hintUsed >= 3) {
                        elements.hintBtn.disabled = true;
                    }
                }
            }
        }
        
        function endGame() {
            clearInterval(gameState.timerInterval);
            
            const minutes = Math.floor(gameState.timer / 60);
            const seconds = gameState.timer % 60;
            const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Calcular puntuaci√≥n
            const maxScore = 1000;
            const timePenalty = Math.min(gameState.timer * 5, 500);
            const movePenalty = Math.min(gameState.moves * 2, 300);
            const hintPenalty = gameState.hintUsed * 50;
            const score = Math.max(maxScore - timePenalty - movePenalty - hintPenalty, 100);
            
            let message = '';
            if (score >= 800) message = "¬°Eres incre√≠ble! üíñ";
            else if (score >= 600) message = "¬°Muy bien hecho! üíï";
            else if (score >= 400) message = "¬°Buen trabajo! üíù";
            else message = "¬°Sigue practicando! üíò";
            
            elements.finalStats.innerHTML = `
                <div class="score-message">${message}</div>
                <p>‚è±Ô∏è Tiempo: ${timeString}</p>
                <p>üîÑ Movimientos: ${gameState.moves}</p>
                <p>‚≠ê Puntuaci√≥n: ${score} puntos</p>
                <p>üí° Pistas usadas: ${gameState.hintUsed}</p>
            `;
            
            setTimeout(() => {
                elements.victoryMessage.classList.add('show');
                createFireworksEffect();
            }, 1000);
        }
        
        function resetGame() {
            clearInterval(gameState.timerInterval);
            
            const config = difficultyConfig[gameState.difficulty];
            
            gameState = {
                moves: 0,
                pairsFound: 0,
                totalPairs: config.pairs,
                timer: 0,
                timerInterval: null,
                flippedCards: [],
                canFlip: true,
                gameStarted: false,
                difficulty: gameState.difficulty,
                cards: [],
                gridSize: config.gridSize,
                hintUsed: 0
            };
            
            elements.victoryMessage.classList.remove('show');
            elements.startBtn.disabled = false;
            elements.hintBtn.disabled = true;
            elements.hintBtn.innerHTML = `<i class="fas fa-lightbulb"></i> Pista (3)`;
            
            createCards();
            updateStats();
            updateGridLayout();
        }
        
        function updateStats() {
            elements.moves.textContent = gameState.moves;
            elements.pairs.textContent = `${gameState.pairsFound}/${gameState.totalPairs}`;
        }
        
        function updateTimer() {
            const minutes = Math.floor(gameState.timer / 60);
            const seconds = gameState.timer % 60;
            elements.timer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        function updateGridLayout() {
            elements.memoryGrid.style.gridTemplateColumns = `repeat(${gameState.gridSize}, 1fr)`;
        }
        
        // Efectos de sonido
        function playFlipSound() {
            const audio = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQ');
            audio.volume = 0.3;
            audio.play().catch(() => {});
        }
        
        function playMatchSound() {
            const audio = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEAQB8AAEAfAAABAAgAZGF0YQ');
            audio.volume = 0.5;
            audio.play().catch(() => {});
        }
        
        // Efectos visuales
        function createHeartsEffect(card) {
            const rect = card.getBoundingClientRect();
            const x = rect.left + rect.width / 2;
            const y = rect.top + rect.height / 2;
            
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const heart = document.createElement('div');
                    heart.innerHTML = 'üíñ';
                    heart.style.position = 'fixed';
                    heart.style.left = `${x}px`;
                    heart.style.top = `${y}px`;
                    heart.style.fontSize = '2rem';
                    heart.style.zIndex = '1000';
                    heart.style.pointerEvents = 'none';
                    heart.style.transform = 'translate(-50%, -50%)';
                    
                    document.body.appendChild(heart);
                    
                    const animation = heart.animate([
                        { transform: 'translate(-50%, -50%) scale(0)', opacity: 1 },
                        { transform: 'translate(-50%, -100px) scale(1.5)', opacity: 0 }
                    ], {
                        duration: 1000,
                        easing: 'ease-out'
                    });
                    
                    animation.onfinish = () => heart.remove();
                }, i * 100);
            }
        }
        
        function createFireworksEffect() {
            // Crear efecto de fuegos artificiales en el centro
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    const particles = 30;
                    for (let j = 0; j < particles; j++) {
                        const particle = document.createElement('div');
                        particle.innerHTML = 'üíñ';
                        particle.style.position = 'fixed';
                        particle.style.left = '50%';
                        particle.style.top = '50%';
                        particle.style.fontSize = '1.5rem';
                        particle.style.zIndex = '9999';
                        particle.style.pointerEvents = 'none';
                        particle.style.transform = 'translate(-50%, -50%)';
                        
                        document.body.appendChild(particle);
                        
                        const angle = (j / particles) * Math.PI * 2;
                        const distance = 100 + Math.random() * 150;
                        
                        const animation = particle.animate([
                            { 
                                transform: 'translate(-50%, -50%) scale(0)', 
                                opacity: 1 
                            },
                            { 
                                transform: `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px) scale(1)`, 
                                opacity: 0 
                            }
                        ], {
                            duration: 1500,
                            easing: 'ease-out'
                        });
                        
                        animation.onfinish = () => particle.remove();
                    }
                }, i * 200);
            }
        }
        
        // Inicializar part√≠culas de fondo
        document.addEventListener('DOMContentLoaded', () => {
            initGame();
            
            // Part√≠culas de fondo
            if (typeof particlesJS !== 'undefined') {
                particlesJS('particles-js', {
                    particles: {
                        number: { value: 40, density: { enable: true, value_area: 800 } },
                        color: { value: "#ff6b8b" },
                        shape: { type: "circle" },
                        opacity: { value: 0.5, random: true },
                        size: { value: 3, random: true },
                        move: { enable: true, speed: 1 }
                    }
                });
            }
            
            // Agregar animaci√≥n de fondo al juego
            const style = document.createElement('style');
            style.textContent = `
                @keyframes bounce {
                    0%, 100% { transform: scale(1); }
                    50% { transform: scale(1.1); }
                }
                
                .memory-card.matched .front {
                    animation: bounce 0.5s ease;
                }
            `;
            document.head.appendChild(style);
        });
    </script>
</body>
</html>
